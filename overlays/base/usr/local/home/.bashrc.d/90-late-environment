if ! tmux_worthy; then
	GPG_TTY="$(tty)"
	export GPG_TTY
fi

if [ ! -e /run/user/$UID/containers/auth.json ] && \
  [ "$(oc whoami --show-server 2>/dev/null)" = "https://api.okd.jharmison.com:6443" ] && \
  oc whoami >/dev/null 2>&1 && \
  podman info >/dev/null 2>&1; then # we're logged into the cluster, we have podman, and we're not logged into any registries
    podman login registry.jharmison.com -u $(oc whoami) -p $(oc whoami -t) >/dev/null 2>&1
fi
